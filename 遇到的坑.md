# 开始

## 小case

1. 列表查询条件不要用自动更新的update_time。
2. 异常要分开监控，特别是参数校验异常。
3. 做查询条件时，要注意边界测试，特别是时间范围。

## 读取excel太大怎么办？

在POI3.8之后，提供了SXSSFWorkbook，这个是支持流处理，通过限制内存中可访问的记录行数来实现低内存利用，当达到限定值时，新一行数据的加入会引起老一行的数据刷新到硬盘，比如内存中限制行数为100，当行号达到101时，行号为0的记录会被刷新到硬盘，并从内存删除，以此类推。

## 分布式事务解决方案

网上找的，说是业务上比较常用的方案。

本地消息表，核心是将事务拆分成本地事务处理。

消息生产方需要额外的消息表，消息表和业务数据要在一个事务里提交。发送失败，需要扫表重试。
消费方需要处理这个消息。业务处理成功，表明成功，可以回成功消息；处理失败，需要重试。如果是业务上的失败，通知生产方业务回滚等操作。